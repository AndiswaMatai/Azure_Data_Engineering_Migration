-- Aggregate fleet utilization by month
SELECT 
    FORMAT(timestamp, 'yyyy-MM') AS Month,
    COUNT(DISTINCT vehicle_id) AS ActiveVehicles,
    SUM(CASE WHEN status = 'active' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS UtilizationRate
FROM curated.fleet_data
GROUP BY FORMAT(timestamp, 'yyyy-MM')
ORDER BY Month;
